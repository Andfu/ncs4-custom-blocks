!function(){"use strict";var e={};function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},t.apply(this,arguments)}e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,{a:i}),i},e.d=function(t,i){for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var i=window.wp.element,n=window.wp.blocks,s=window.wp.blockEditor,r=window.React,a=e.n(r),l=window.wp.components;function o(e){return(0,i.createElement)(i.Fragment,null,e.useInlineSvg?(0,i.createElement)("div",{dangerouslySetInnerHTML:{__html:e.img.data}}):(0,i.createElement)("embed",{type:e.img.mime,src:e.img.url}))}const c=e=>({marginLeft:"left"==e.align?0:"auto",marginRight:"right"==e.align?0:"auto"});function m(e){return e.useInlineSvg=null==e.useInlineSvg||e.useInlineSvg,(0,i.createElement)(s.MediaUploadCheck,null,(0,i.createElement)(s.MediaUpload,{onSelect:e.onChange,value:e.img?e.img.id:null,allowedTypes:["image"],render:t=>{let{open:n}=t;return(0,i.createElement)(l.Button,{className:e.img?"editor-post-featured-image__preview":"editor-post-featured-image__toggle",onClick:n},e.img?"image/svg+xml"===e.img.mime&&e.img.data?(0,i.createElement)(o,{img:e.img,useInlineSvg:e.useInlineSvg,style:c(e)}):(0,i.createElement)("img",{src:e.img.url,style:c(e)}):"Choose an image")}}))}function u(e){let n=e.img&&"image/svg+xml"===e.img.mime&&e.img.data;return e.useInlineSvg=null==e.useInlineSvg||e.useInlineSvg,(0,i.createElement)(i.Fragment,null,n&&!e.useInlineSvg?(0,i.createElement)("embed",{type:e.img.mine,src:e.img.url}):(0,i.createElement)("div",t({},e,n?{dangerouslySetInnerHTML:{__html:e.img.data,style:c(e)}}:{}),e.img&&!n?(0,i.createElement)("img",{src:e.img.url,style:c(e)}):null))}class g extends a().Component{constructor(e){super(e),this.attributes=e.attributes}createClassName(e){return["ncs4-bp-topic"].join(" ")+" "+e}render(){let e=this.props.blockProps;return(0,i.createElement)("a",t({},e,{className:this.createClassName(e.className),href:this.attributes.link}),(0,i.createElement)(p,{text:this.attributes.title}),(0,i.createElement)(d,{img:this.attributes.img,svg:this.attributes.svg}),(0,i.createElement)("div",{className:"ncs4-bp-topic__overlay"}))}}class p extends a().Component{constructor(e){super(e),this.text=e.text}render(){return(0,i.createElement)("div",{className:"ncs4-bp-topic__text-area"},(0,i.createElement)("p",null,this.text))}}class d extends a().Component{render(){return this.img&&"image/svg+xml"===this.img.mime&&this.svg,(0,i.createElement)(u,{className:"ncs4-bp-topic__icon-area",img:this.props.img})}}var h=window.wp.data;class b extends a().Component{constructor(e){super(e),this.attributes=e.attributes,this.clientId=e.clientId,this.setAttributes=e.setAttributes,this.setStateAttributes=this.setStateAttributes.bind(this),this.handleSelected=this.handleSelected.bind(this),this.state={editMode:!1,title:e.attributes.title,link:e.attributes.link,img:e.attributes.img},wp.data.subscribe(this.handleSelected)}createClassName(e){return["ncs4-bp-topic"].join(" ")+" "+e}setStateAttributes(e){this.setState(e,(()=>{this.setAttributes(e)}))}handleSelected(){let e=(0,h.select)("core/block-editor").getSelectedBlock();e&&(this.state.editMode||e.clientId!==this.clientId?this.state.editMode&&e.clientId!==this.clientId&&this.setState({editMode:!1}):this.setState({editMode:!0}))}render(){let e=this.props.blockProps;return(0,i.createElement)("div",t({className:"ncs4-bp-topic__wrapper"},e),this.state.editMode?(0,i.createElement)(v,{attributes:this.state,onChange:e=>{this.setStateAttributes({img:e})}}):(0,i.createElement)(g,{attributes:this.state,blockProps:e}))}}class v extends a().Component{render(){let e=this.props.attributes,t=this.props.onChange;return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(l.TextControl,{label:"Topic",placeholder:"Best Practices Topic",value:e.title,onChange:t}),(0,i.createElement)(l.TextControl,{label:"Topic page link",help:"Link to the topic page",placeholder:"/resources/best-practices/my-topic",value:e.link,onChange:t}),(0,i.createElement)(m,{onChange:e=>function(e,t){arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||"image/svg+xml"!==e.mime?t(e):fetch(e.url).then((e=>e.text())).then((i=>{e.data=i,t(e)}))}(e,t),img:e.img}))}}(0,n.registerBlockType)("ncs4-custom-blocks/bp-topic",{apiVersion:2,title:"Best Practices Topic",icon:"links",category:"layout",attributes:{title:{type:"string"},link:{type:"string"},img:{type:"object"},svg:{type:"string"}},edit:e=>(0,i.createElement)(b,t({},e,{blockProps:(0,s.useBlockProps)()})),save:e=>(0,i.createElement)(g,t({},e,{blockProps:s.useBlockProps.save()}))})}();