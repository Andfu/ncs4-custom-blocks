!function(){"use strict";var t={};function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},e.apply(this,arguments)}t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,{a:i}),i},t.d=function(e,i){for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var i=window.wp.element,s=window.wp.blocks,n=window.wp.blockEditor,l=window.React,a=t.n(l),r=window.wp.components,o=window.wp.data;class c extends a().Component{constructor(t){var e,i;super(t),i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return["ncs4-section","ncs4-bp-content",e?"ncs4-bp-content__"+e:null].join(" ")+" "+t},(e="createClassName")in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.attributes=t.attributes}sanitize_string(t){if("string"==typeof t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="àáäâèéëêìíïîòóöôùúüûñçěščřžýúůďťň·/_,:;",i=0,s=e.length;i<s;i++)t=t.replace(new RegExp(e.charAt(i),"g"),"aaaaeeeeiiiioooouuuuncescrzyuudtn------".charAt(i));return t.replace(".","-").replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/\//g,"")}}render(){throw new Error("BPSection child has not implemented render()")}}class h extends c{constructor(t){super(t),this.setAttributes=t.setAttributes,this.clientId=t.clientId,this.getBlockList=this.getBlockList.bind(this),this.signalChildren=this.signalChildren.bind(this),this.updateChildrenTitles=this.updateChildrenTitles.bind(this),this.onWPData=this.onWPData.bind(this),this.updateInheritedTitle=this.updateInheritedTitle.bind(this),this.updateTitle=this.updateTitle.bind(this),this.setStateAttributes=this.setStateAttributes.bind(this),this.setShowTitle=this.setShowTitle.bind(this),this.setOptionCreateAnchor=this.setOptionCreateAnchor.bind(this),this.setAnchorSlug=this.setAnchorSlug.bind(this),this.state={title:this.attributes.title,inheritedTitle:this.attributes.inheritedTitle,showTitle:this.attributes.showTitle,optionCreateAnchor:this.attributes.optionCreateAnchor,anchorSlug:this.attributes.anchorSlug,blockList:this.getBlockList()}}componentDidMount(){document.addEventListener("sectionTitleUpdate_"+this.clientId,(t=>{this.updateInheritedTitle(t.detail.title)})),document.addEventListener("requestTitle",(t=>{let e=this.getBlockList();e.includes(t.detail.id)&&(this.signalChild("sectionTitleUpdate",{title:this.state.title||this.state.inheritedTitle},t.detail.id),this.setState({blockList:e}))})),wp.data.subscribe(this.onWPData),this.state.inheritedTitle||document.dispatchEvent(new CustomEvent("requestTitle",{detail:{id:this.clientId}}))}componentWillUnmount(){document.removeEventListener("sectionTitleUpdate_"+this.clientId,(t=>{this.updateInheritedTitle(t.detail.title)}))}getBlockList(){return(0,o.select)("core/block-editor").getBlockOrder(this.clientId)}signalChild(t,e,i){document.dispatchEvent(new CustomEvent(t+"_"+i,{detail:e}))}signalChildren(t,e){for(let i of(0,o.select)("core/block-editor").getBlockOrder(this.clientId))this.signalChild(t,e,i)}updateChildrenTitles(t){this.signalChildren("sectionTitleUpdate",{title:t})}onWPData(){let t=this.getBlockList();t!=this.state.blockList&&this.setState({blockList:t})}updateInheritedTitle(t){this.setState({inheritedTitle:t},(()=>{this.setAttributes({inheritedTitle:t})})),this.state.title||this.updateChildrenTitles(t)}updateTitle(t){this.setState({title:t},(()=>{this.setAttributes({title:t})})),t?this.updateChildrenTitles(t):this.updateChildrenTitles(this.state.inheritedTitle)}setStateAttributes(t){this.setState(t,(()=>{this.setAttributes(t)}))}setShowTitle(t){this.setStateAttributes({showTitle:t})}setOptionCreateAnchor(t){this.setStateAttributes({optionCreateAnchor:t})}setAnchorSlug(t){this.setStateAttributes({anchorSlug:t})}}class d extends h{constructor(t){super(t),this.attributes=t.attributes,this.clientId=t.clientId,this.setAttributes=t.setAttributes,this.updateTitle=this.updateTitle.bind(this),this.updateIndex=this.updateIndex.bind(this),this.updateLink=this.updateLink.bind(this);let e=this.state;this.state={...e,inheritedTitle:null,id:t.attributes.id,link:t.attributes.link},document.addEventListener("subtopicsUpdate",this.updateIndex)}createClassName(t){return["ncs4-bp-subtopic"].join(" ")+" "+t}updateTitle(t){super.updateTitle(t),document.dispatchEvent(new CustomEvent("titleUpdate",{detail:{id:this.clientId,index:this.state.id,oldTitle:this.state.title,newTitle:t}})),this.setState({title:t}),this.setAttributes({title:t})}updateLink(t){const e=this.dashEncode(t);this.setState({link:e}),this.setAttributes({link:e})}updateIndex(t){let{detail:{id:e,index:i}}=t;e==this.clientId&&this.setState({id:i},(()=>{this.setAttributes({id:i})}))}dashEncode(t){return t.replaceAll(/[^\w]+/g,"-").replaceAll(/_+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}render(){let t=this.props.blockProps;return(0,i.createElement)(i.Fragment,null,(0,i.createElement)("section",e({},t,{id:"ncs4-bp-subtopic__"+this.attributes.id,className:this.createClassName(t.className),style:{display:"block"}}),(0,i.createElement)("h2",{className:"ncs4-bp-subtopic-title"},this.state.title),(0,i.createElement)(n.InnerBlocks,null)),(0,i.createElement)(n.InspectorControls,null,(0,i.createElement)(r.PanelBody,{title:"General",initialOpen:!0},(0,i.createElement)(r.TextControl,{label:"Title",placeholder:"Subtopic Title...",value:this.state.title,onChange:t=>{this.updateTitle(t),this.updateLink(t)}}))))}}class u extends a().Component{constructor(t){super(t),this.attributes=t.attributes}createClassName(t){return["ncs4-bp-subtopic"].join(" ")+" "+t}render(){let t=this.props.blockProps;return(0,i.createElement)("section",e({},t,{id:"ncs4-bp-subtopic__"+this.attributes.id,className:this.createClassName(t.className)}),(0,i.createElement)("div",{id:this.attributes.link,className:"bp-subtopic-anchor"}),(0,i.createElement)("h2",{className:"ncs4-bp-subtopic-title"},this.attributes.title,(0,i.createElement)("a",{href:"#"+this.attributes.link,className:"share-section",title:"Share this section"},(0,i.createElement)("span",{class:"dashicons dashicons-share"}))),(0,i.createElement)(n.InnerBlocks.Content,null))}}(0,s.registerBlockType)("ncs4-custom-blocks/bp-subtopic",{apiVersion:2,title:"Best Practices Subtopic",parent:["ncs4-custom-blocks/bp-content"],icon:"admin-page",category:"layout",attributes:{title:{type:"string",default:"Title"},link:{type:"string",default:""},id:{type:"number",default:-1}},edit:t=>(0,i.createElement)(d,e({},t,{blockProps:(0,n.useBlockProps)()})),save:t=>(0,i.createElement)(u,e({},t,{blockProps:n.useBlockProps.save()}))})}();